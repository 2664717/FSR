<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Видео с рейтингом</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="video-wrapper" id="videoWrapper">
      <video id="videoPlayer" muted playsinline controls>
        <source
          src="https://api.telegram.org/file/bot8228104804:AAG5ngi3-TGe3eIIP1PT7-L7Zky3AuLtW4s/videos/file_1.MOV"
          type="video/mp4"
        />
        Ваш браузер не поддерживает видео.
      </video>

      <!-- Рейтинг -->
      <div class="rating-container">
        <div class="rating-scroll" id="ratingScroll">
          <button class="rating-btn negative">-5</button>
          <button class="rating-btn negative">-4</button>
          <button class="rating-btn negative">-3</button>
          <button class="rating-btn negative">-2</button>
          <button class="rating-btn negative">-1</button>
          <button class="rating-btn zero">0</button>
          <button class="rating-btn positive">1</button>
          <button class="rating-btn positive">2</button>
          <button class="rating-btn positive">3</button>
          <button class="rating-btn positive">4</button>
          <button class="rating-btn positive">5</button>
        </div>
      </div>

      <!-- Fullscreen -->
      <button id="fullscreenBtn" class="fullscreen-btn">⛶</button>
    </div>

    <script>
      const video = document.getElementById("videoPlayer");
      const wrapper = document.getElementById("videoWrapper");
      const fullscreenBtn = document.getElementById("fullscreenBtn");
      const ratingButtons = document.querySelectorAll(".rating-btn");
      let currentRating = null;

      // --- Попробуем запустить видео ---
      video.addEventListener("canplay", () => {
        video.play().catch(() => {
          console.log("⚠️ Требуется взаимодействие пользователя для старта видео.");
        });
      });

      // --- Поведение рейтинга ---
      ratingButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const value = parseInt(btn.textContent);
          if (currentRating === value) {
            currentRating = null;
            btn.classList.remove("active");
          } else {
            currentRating = value;
            ratingButtons.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
          }
          console.log("Отправка рейтинга:", currentRating);
        });
      });

      // --- Полноэкранный режим ---
      fullscreenBtn.addEventListener("click", () => {
        if (!document.fullscreenElement) {
          wrapper.requestFullscreen().catch(err => console.error(err));
        } else {
          document.exitFullscreen();
        }
      });

      // --- Когда меняется fullscreen ---
      document.addEventListener("fullscreenchange", () => {
        if (document.fullscreenElement) {
          fullscreenBtn.textContent = "❌";
        } else {
          fullscreenBtn.textContent = "⛶";
        }
      });
    </script>
  </body>
</html>
